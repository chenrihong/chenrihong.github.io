# 08.校验表单函数

上线时间：20250826

:::danger[工单：202508211539000516432]
人才遴选申请，多表单情况下，子表单文本、附件必填的校验没有判断
:::


## 函数名

| 函数名 | 功能 |
| ---- | ---- |
| validateForm | 按钮上使用 |


## 示例

```js
this.validateForm({ formid: 'xxxxxxxxxxxxxxx'}).then(res=>{
  if(!res.flag){
      // 表单校验未通过
  }
})
```


### 工单实例

```js

const empId = this.getFormVal({ col: "emp_id", formid: "000120250415152427QHRP5KA2" })
const assessmentId = this.getFormVal({ col: "assessment_id", formid: "000120250415152427QHRP5KA2" })
console.log('111', empId, assessmentId)
http.post(`/a0/oa/talent/checkRecord?empId=${empId}&assessmentId=${assessmentId}`, {
    data: {


        "000120250415161505WYE5F5NR": "学术任职",
        "000120250415161455JNDIJO": "入选人才计划",
        "000120250325135300ZK29DNYA": "各类平台建设",
        "000120250415161453Y59I9YVV": "论文",
        "0001202504151615067IPZ9E64": "著作（教材）",
        "000120250415161451LOCVJXAI": "科研（教改）项目",
        "000120250415161449UTYZJV2": "成果获奖",
        "0001202504151614478UJJFL7T": "专利",
        "000120250415161458Z1KV32F": "荣誉",
        "00012025060516534145WXM6E": "标准（指南）"
    }
}).then(res => {
    // console.log(res)
    if (res.data.code == 200) {
        const rows = this.getGridRows({
            gid: '1744762862153'
        });

        const errList = [];
        if (rows && rows.length > 0) {
            for (let i = 0; i < rows.length; i++) {
                if ((rows[i] && rows[i].control_type == 2) && (rows[i] && rows[i].true_flag == 0)) {
                    errList.push(rows[i].order_num);
                }
            }

            if (errList && errList.length > 0) {
                const str = errList.toString();
                window.message.pc.error(`第${str}行不满足条件,无法提交，请补充核对！`);
                // this.getMessageBoxConfirm(`第${str}行不满足条件，请补充核对！`).then((res) => {
                //     if (res) {
                //         const isPromiseChecked = this.getFormVal({ formid: '1748477953707', col: 'applier_commit_flalg' });

                //         console.log({ isPromiseChecked })

                //         if (isPromiseChecked != '1') {
                //             window.message.pcbox.alert('请先勾选本人承诺', '提示', {
                //                 callback: () => {
                //                     this.switchTab({ tabid: '000120250415152427CIL5WE8R', tabname: '其他业绩' });
                //                 }
                //             });
                //         } else {
                //             this.setFormVal({ formid: '000120250415152427QHRP5KA2', subformid: ['0001202504151524271337Q45V', '1748477953707'] });
                //             this.saveFormFlow()
                //         }
                //     }
                // })
            } else {
                const isPromiseChecked = this.getFormVal({ formid: '1748477953707', col: 'applier_commit_flalg' });

                console.log({ isPromiseChecked })

                if (isPromiseChecked != '1') {
                    window.message.pcbox.alert('请先勾选本人承诺', '提示', {
                        callback: () => {
                            this.switchTab({ tabid: '000120250415152427CIL5WE8R', tabname: '其他业绩' });
                        }
                    });
                } else {
                    // 增加表单校验
                    this.validateForm({ formid: '1748477953707' }).then(res => {
                        if (res.flag) {
                            this.setFormVal({ formid: '000120250415152427QHRP5KA2', subformid: ['0001202504151524271337Q45V', '1748477953707'] });
                            this.saveFormFlow()
                        } else {
                            this.switchTab({ tabid: '000120250415152427CIL5WE8R', tabname: '其他业绩' });
                            this.validateForm({ formid: '1748477953707' });
                        }
                    })

                    // this.setFormVal({ formid: '000120250415152427QHRP5KA2', subformid: ['0001202504151524271337Q45V', '1748477953707'] });
                    // this.saveFormFlow()
                }
            }
        } else {
            window.message.pc.error('没有数据')
        }
    }
})

```
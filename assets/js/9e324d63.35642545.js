"use strict";(self.webpackChunkthoth_docs=self.webpackChunkthoth_docs||[]).push([[8379],{3490:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>a});var t=r(5452),i=r(4848),s=r(8453);const o={title:"\u89e3\u51b3KeepAlive\u7f13\u5b58\u95ee\u9898",authors:["chenrihong"],date:new Date("2024-12-04T00:00:00.000Z"),tags:["\u601d\u8003"]},l="\u601d\u8003",c={authorsImageUrls:[void 0]},a=[{value:"\u80cc\u666f",id:"\u80cc\u666f",level:2},{value:"\u52a8\u6001\u8def\u7531\u914d\u7f6e",id:"\u52a8\u6001\u8def\u7531\u914d\u7f6e",level:2},{value:"\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7ec4\u4ef6\u5b9e\u4f8b",id:"\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7ec4\u4ef6\u5b9e\u4f8b",level:2},{value:"\u9875\u7b7e\u5173\u95ed\u65f6\u6e05\u7406 includesArr \u6570\u7ec4",id:"\u9875\u7b7e\u5173\u95ed\u65f6\u6e05\u7406-includesarr-\u6570\u7ec4",level:2},{value:"\u7ec8\u5c40",id:"\u7ec8\u5c40",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"\u80cc\u666f",children:"\u80cc\u666f"}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u53f8\u7684\u7cfb\u7edf\u662f\u91c7\u7528 Vue3.0 \u6846\u67b6\uff0c\u524d\u540e\u5206\u79bb\u6a21\u5f0f\uff0c\u7528\u9875\u7b7e\u6765\u52a0\u8f7d\u8def\u7531\uff0c\u4e14\u9700\u8981\u7f13\u5b58\u8fd9\u4e9b\u9875\u7b7e\uff0c\u4ee5\u9632\u5207\u6362\u56de\u6765\u65f6\u6570\u636e\u4e22\u5931\u3002\u6240\u4ee5\u91c7\u7528\u4e86 keep-alive\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u968f\u4e4b\u800c\u6765\u7684\u662f\u5185\u5b58\u5360\u7528\u9ad8\u7684\u95ee\u9898\uff0c\u7528\u6237\u7528\u7740\u7528\u7740\uff0c\u5185\u5b58\u5c31\u8d85\u8fc71GB\uff0c\u521d\u671f\u751a\u81f3\u52302\u52303GB\u4ee5\u4e0a\u3002\u7ecf\u8fc7\u4e00\u7cfb\u7edf\u4f18\u5316\uff0c\u5185\u5b58\u8fd8\u662f1GB\u4ee5\u4e0a\uff0c\u5ba2\u6237\u73b0\u573a\u7528360\u6d4f\u89c8\u5668\u8fd8\u4f1a\u767d\u5c4f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u4e3a\u6d4f\u89c8\u5668\u5185\u5b58\u9650\u5236\uff0c360\u4f1a\u5207\u5230\u517c\u5bb9\u6a21\u5f0f\uff0c\u5bfc\u81f4\u767d\u5c4f\u3002\u8c37\u6b4c\u6d4f\u89c8\u5668\u5219\u4f1a\u5d29\u6e83\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u52a8\u6001\u8def\u7531\u914d\u7f6e",children:"\u52a8\u6001\u8def\u7531\u914d\u7f6e"}),"\n",(0,i.jsxs)(n.p,{children:["\u52a8\u6001\u8def\u7531\u7ec4\u4ef6\uff0c\u8981\u7f13\u5b58\uff0c\u9700\u8981\u914d\u7f6e\u8def\u7531\u7684 ",(0,i.jsx)(n.code,{children:"key=route.fullPath"}),"\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'<router-view v-slot="{ Component, route }">\n    <transition :name="subsystemConfig.routerAnimate" appear>\n        <keep-alive :max="5">\n            <component :is="Component" :key="route.fullPath" />\n        </keep-alive>\n    </transition>\n</router-view>\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u968f\u4e4b\u5e26\u6765\u7684\u95ee\u9898\u662f\uff0c\u5173\u95ed\u9875\u7b7e\u65f6\uff0c\u65e0\u6cd5\u91ca\u653e\u7ec4\u4ef6\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7ec4\u4ef6\u5b9e\u4f8b",children:"\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7ec4\u4ef6\u5b9e\u4f8b"}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd4\u56de\u65b0\u7ec4\u4ef6\uff0c\u540c\u65f6\u53ef\u4ee5\u5bf9\u7ec4\u4ef6\u547d\u540d\uff0c\u4ee5\u65b9\u4fbf\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"keep-alive "}),"\u7684 ",(0,i.jsx)(n.code,{children:"include"})," \u914d\u7f6e"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:' <router-view v-slot="{ Component, route }">\n    <transition :name="subsystemConfig.routerAnimate" appear>\n        <keep-alive :include="includesArr" :max="5">\n            <component :is="wrap(Component, route)" \n            :key="route.query.__id || route.path" />\n        </keep-alive>\n    </transition>\n</router-view>\n'})}),"\n",(0,i.jsx)(n.p,{children:"wrap:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"wrap(component: any, route: any) {\n    const { query } = route;\n    let key = query.__id;\n    if (!key) return component;\n    if (key === null) {\n        console.error('__id is null');\n    }\n    let wrapper;\n    if (this.cachedWrapperComponents.has(key)) {\n        wrapper = this.cachedWrapperComponents.get(key);\n    } else {\n        wrapper = defineComponent({\n            name: key,\n            render: () => component\n        })\n        this.includesArr.push(key);\n        this.cachedWrapperComponents.set(key, wrapper);\n    }\n    return wrapper;\n},\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u9875\u7b7e\u5173\u95ed\u65f6\u6e05\u7406-includesarr-\u6570\u7ec4",children:"\u9875\u7b7e\u5173\u95ed\u65f6\u6e05\u7406 includesArr \u6570\u7ec4"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u9875\u7b7e\u5173\u95ed\u65f6\uff0c\u6e05\u7406 ",(0,i.jsx)(n.code,{children:"includesArr"}),"\uff0c\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"keep-alive"})," \u81ea\u52a8\u6e05\u7406\u7ec4\u4ef6\u7f13\u5b58\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u4ee5\u4e3a\u80fd\u505a\u90fd\u505a\u4e86\uff0c\u5168\u90e8\u4ea4\u7ed9 ",(0,i.jsx)(n.code,{children:"Vue"})," \u6846\u67b6\u5c31\u884c\uff0c\u4e8b\u5b9e\u662f\uff0c\u6240\u6709\u7ec4\u4ef6\u7684  ",(0,i.jsx)(n.code,{children:"unmounted"})," \u94a9\u5b50\u90fd\u6ca1\u6709\u89e6\u53d1\u3002\u5185\u5b58\u5360\u7528\u8fd8\u662f\u5f88\u9ad8\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u76f4\u5230\u6700\u8fd1\uff0c\u7528\u6237\u53d1\u73b0\u7f13\u5b58\u5bfc\u81f4\u4fdd\u5b58\u6570\u636e\u5931\u8d25\u95ee\u9898\uff0c\u6211\u4eec\u91cd\u65b0\u5ba1\u89c6\u8fd9\u4e00\u5757\u529f\u80fd\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u7ec8\u5c40",children:"\u7ec8\u5c40"}),"\n",(0,i.jsxs)(n.p,{children:["\u6211\u4eec\u540c\u4e8b\u53d1\u73b0\uff0c\u5148\u5bf9 includesArr \u6e05\u7406\u518d\u5173\u95ed\u8def\u7531\uff0c\u4e0d\u4f1a\u89e6\u53d1\u7ec4\u4ef6",(0,i.jsx)(n.code,{children:"unmounted"})," \u94a9\u5b50\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u800c\u5173\u95ed\u65f6\uff0c\u5148\u628a\u8def\u7531\u5207\u8d70\uff0c\u518d\u53bb\u6e05\u7406 includesArr \u4f1a\u89e6\u53d1\u7ec4\u4ef6 ",(0,i.jsx)(n.code,{children:"unmounted"})," \u94a9\u5b50\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u6b64\uff0c\u6211\u89c9\u5f97\u5e94\u8be5\u662f\u6b63\u5e38\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 ",(0,i.jsx)(n.code,{children:"unmounted"})," \u4e2d\u5199\u4e00\u4e9b\u91ca\u653e\u5185\u5b58\u7684\u4ee3\u7801\u4e86\u3002"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var t=r(6540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},5452:e=>{e.exports=JSON.parse('{"permalink":"/blog/2024/12/04/\u89e3\u51b3 keep-alive \u7f13\u5b58\u95ee\u9898","editUrl":"https://github.com/chenrihong/chenrihong.github.io/tree/main/blog/2024/12-04-\u89e3\u51b3 keep-alive \u7f13\u5b58\u95ee\u9898.md","source":"@site/blog/2024/12-04-\u89e3\u51b3 keep-alive \u7f13\u5b58\u95ee\u9898.md","title":"\u89e3\u51b3KeepAlive\u7f13\u5b58\u95ee\u9898","description":"\u80cc\u666f","date":"2024-12-04T00:00:00.000Z","tags":[{"inline":false,"label":"\u601d\u8003","permalink":"/blog/tags/think","description":"\u8bb0\u5f55\u81ea\u5df1\u7684\u4e00\u4e9b\u601d\u8003\u611f\u609f"}],"readingTime":2.56,"hasTruncateMarker":false,"authors":[{"name":"\u9648\u65e5\u7ea2","title":"\u8f6f\u4ef6\u5de5\u7a0b\u5e08","url":"https://github.com/chenrihong","page":{"permalink":"/blog/authors/chenrihong"},"socials":{"github":"https://github.com/chenrihong"},"imageURL":"https://avatars.githubusercontent.com/u/5441801","key":"chenrihong"}],"frontMatter":{"title":"\u89e3\u51b3KeepAlive\u7f13\u5b58\u95ee\u9898","authors":["chenrihong"],"date":"2024-12-04T00:00:00.000Z","tags":["\u601d\u8003"]},"unlisted":false,"nextItem":{"title":"\u4eca\u65e9\u6cc9\u601d\u5982\u6d8c","permalink":"/blog/welcome"}}')}}]);
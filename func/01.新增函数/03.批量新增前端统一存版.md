# 03.批量新增前端统一存版

Date: 2025-11-11

:::tip[前端统一保存版本]

解决批量新增的使用场景，之前都是批量新增时直接落库的

:::

开发中，尚未完成，需求工单： _202511111340000049437_

1. 问题描述
```
PM计划：选中记录，编辑计划，选中新的模板后，会覆盖掉旧模板，点击取消，再次
打开就是新模板了，和点击保存是一样的效果。
回复：现在平台框架就是如此，再选择模板的时候就落库了，不然pm明细出不来;
选择模板的页面，把明细也展示出来，点击选中后，在计划页面展示缓存的明细，确认修改后再落库;
```

2. 解决方案
```
前端：
1.PM计划明细表格 行编辑支持，编辑后 不立即调用接更新数据， 前端暂存
2.PM计划明细表格 行删除 支持，删除后不立即调用接口 更新数据，前端打作废标志，隐藏数据
3.【选择模板】 弹窗 选择数据，把对应模板，风险等级更新到PM计划主表。
模板明细数据， 加载到 PM计划明细表格，此时 都是前端操作，不调用接口 处理后台数据
4.【增加项目】支持增加表格行

平台后端：
1.通用保存接口 主表更新保存，明细表 要判断 是增，删，改 操作。
做相应的处理（如果已经支持那就不用动了）
```




## 函数名

> this.pickRowsClick

## 参数

1. pageid 页面ID, 不配置时，使用按钮绑的明细页面id，或表格区绑的明细页面id
2. pickConfig: 选择配置。
    - pkCok: string. 再次打开选择界面时，使用此字段作为过滤弹窗中的数据。

## 示例

```js
this.pickRowsClick({
    pageid: "0000120251112112400QNB7R2O",
    grid:'0000120251112112400KE6XBHR7',
    pickConfig:{
        pkCol:'exam_id'
    }
})
```

## 数据集配置

### 表格数据集须要支持条件：`SELECTED_ID`

选择界面需要提供条件字段，用于过滤已选数据。此条件满足：
1. 必面是隐藏
2. 必须用 List 入参
3. 必须用参数名`SELECTED_ID`

### 数据集举例

```sql
select * from scm_pm_exam plan where DELETE_FLAG=0
${
(emptyparam("HOSP_ID")==false ? " and HOSP_ID=:HOSP_ID" : "" ) 
+ (emptyparam("TENANT_ID")==false ? " and TENANT_ID=:TENANT_ID" : "" ) 
+ (emptyparam("EXAM_ID")==false ? " and EXAM_ID=:EXAM_ID" : "" ) 
+ (emptyparam("MODEL_ID")==false ? " and MODEL_ID=:MODEL_ID" : "" ) 
+ (emptyparam("PROJECT_ID")==false ? " and PROJECT_ID=:PROJECT_ID" : "" ) 
+ (emptyparam("EXAM_CONTENT")==false ? " and EXAM_CONTENT=:EXAM_CONTENT" : "" ) 
+ (emptyparam("SELECTED_ID")==false ? " and EXAM_ID NOT IN(:SELECTED_ID)" : "" )  -- 这里
+#keyword
}
```